<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Desaf√≠o M.A.S. - Prof. Victor</title>
    <style>
        body { 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            background: #e9ecef; 
            display: flex; 
            justify-content: center; 
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px; 
        }
        .card { 
            background: white; 
            width: 100%; 
            max-width: 480px; 
            padding: 40px; 
            border-radius: 20px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
            text-align: center; 
            position: relative;
        }
        .hidden { display: none !important; }
        input { 
            width: 100%; 
            padding: 14px; 
            margin: 10px 0; 
            border: 2px solid #dee2e6; 
            border-radius: 10px; 
            font-size: 1rem; 
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input:focus { border-color: #007bff; outline: none; }
        button { 
            padding: 15px 25px; 
            cursor: pointer; 
            border: none; 
            border-radius: 12px; 
            font-weight: bold; 
            font-size: 1rem; 
            margin: 8px; 
            transition: all 0.2s; 
        }
        button:active { transform: scale(0.96); }
        .btn-start { background: #007bff; color: white; width: 100%; margin-top: 15px; }
        .btn-start:hover { background: #0056b3; }
        .btn-opt { background: #ffffff; color: #333; border: 2px solid #dee2e6; width: 100%; margin: 5px 0; text-align: left; padding: 12px 20px; font-weight: 500; }
        .btn-opt:hover { background: #f8f9fa; border-color: #adb5bd; }
        .btn-next-level { background: #fd7e14; color: white; width: 100%; margin-top: 15px; }
        
        #timerContainer {
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #495057;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .timer-warning { color: #dc3545 !important; animation: pulse 1s infinite; }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .formula { font-size: 1.4rem; font-weight: bold; margin: 25px 0; color: #212529; line-height: 1.4; background: #f8f9fa; padding: 15px; border-radius: 10px; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        .v-box { background: #e7f1ff; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #b6d4fe; font-size: 1rem; text-align: left; }
        .stats { font-size: 0.95rem; color: #495057; margin-bottom: 20px; border-bottom: 2px solid #f1f3f5; padding-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .badge { background: #e7f1ff; color: #007bff; padding: 6px 12px; border-radius: 30px; font-weight: bold; }
        .badge-level { background: #fff4e6; color: #fd7e14; padding: 6px 12px; border-radius: 30px; font-weight: bold; }

        .report-box { text-align: left; background: #f8f9fa; padding: 25px; border-radius: 15px; border: 1px solid #e9ecef; margin-top: 20px; }
        .report-item { margin-bottom: 12px; display: flex; justify-content: space-between; border-bottom: 1px dashed #dee2e6; padding-bottom: 5px; }
        .report-label { color: #6c757d; font-weight: 500; }
        .report-value { font-weight: bold; color: #212529; }
        .success-text { color: #28a745; font-weight: bold; }
        .fail-text { color: #dc3545; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <!-- PANTALLA INICIAL -->
    <div id="pantallaInicio">
        <h2 style="color: #212529; margin-bottom: 5px;">Desaf√≠o M.A.S.</h2>
        <p style="color: #6c757d; margin-bottom: 30px;">Conceptos y F√≥rmulas | Prof. Victor</p>
        <input type="text" id="inputNombre" placeholder="Nombre del alumno">
        <input type="text" id="inputEquipo" placeholder="Grado / Grupo / Equipo">
        <p style="font-size: 0.9rem; color: #888;">‚è≥ Tiempo: 120s por nivel</p>
        <button class="btn-start" onclick="comenzarJuego(1)">INICIAR DESAF√çO</button>
    </div>

    <!-- PANTALLA DE JUEGO -->
    <div id="pantallaJuego" class="hidden">
        <div id="timerContainer">
            ‚è±Ô∏è <span id="timerDisplay">02:00</span>
        </div>
        <div class="stats">
            <div>
                <span id="displayNombre" style="font-weight: bold; font-size: 1.1rem;"></span>
                <div id="displayEquipo" style="font-size: 0.85rem; color: #6c757d;"></div>
            </div>
            <div style="text-align: right;">
                <span class="badge-level" id="displayNivel">Nivel 1</span><br>
                <span class="badge" style="margin-top: 5px; display: inline-block;">Preg <span id="numPregunta">1</span>/10</span>
            </div>
        </div>
        <div id="zonaLogica">
            <div class="v-box" id="txtContexto"></div>
        </div>
        <div class="formula" id="areaPregunta"></div>
        <div id="areaBotones"></div>
    </div>

    <!-- PANTALLA FINAL -->
    <div id="pantallaFinal" class="hidden">
        <h2 id="tituloFinal" style="margin-bottom: 10px;"></h2>
        <div id="scoreDetalle" style="font-size: 3rem; font-weight: 800; color: #212529; margin: 10px 0;"></div>
        
        <div class="report-box">
            <div class="report-item">
                <span class="report-label">Nombre:</span>
                <span class="report-value" id="resNombre"></span>
            </div>
            <div class="report-item">
                <span class="report-label">Equipo:</span>
                <span class="report-value" id="resEquipo"></span>
            </div>
            <div class="report-item">
                <span class="report-label">Nivel 1 (Bases):</span>
                <span class="report-value" id="resNivel1">-</span>
            </div>
            <div class="report-item">
                <span class="report-label">Nivel 2 (F√≥rmulas):</span>
                <span class="report-value" id="resNivel2">-</span>
            </div>
            <div class="report-item" style="border-top: 2px solid #dee2e6; margin-top: 10px; padding-top: 10px;">
                <span class="report-label">Estado Final:</span>
                <span class="report-value" id="resEstado"></span>
            </div>
            <div class="report-item" style="border: none;">
                <span class="report-label">Fecha:</span>
                <span class="report-value" id="resFecha"></span>
            </div>
        </div>
        <div id="contenedorAccionesFinales"></div>
        <p style="margin-top: 25px; font-size: 0.8rem; color: #adb5bd; text-transform: uppercase;">Control Acad√©mico - Prof. Victor</p>
    </div>
</div>

<script>
    let nivelActual = 1;
    let preguntaActual = 1;
    let aciertosNivel1 = 0;
    let aciertosNivel2 = 0;
    let aciertosEnNivelActual = 0;
    let respuestaCorrecta = null;
    let nombreUsuario = "";
    let equipoUsuario = "";
    let timeLeft = 120; 
    let timerId = null;

    const preguntasNivel1 = [
        { c: "Tiempo empleado en completar un ciclo de oscilaci√≥n.", q: "¬øQu√© magnitud es?", r: "Periodo (T)", o: ["Frecuencia", "Fase", "Amplitud"] },
        { c: "N√∫mero de ciclos realizados en la unidad de tiempo.", q: "¬øCu√°l es?", r: "Frecuencia (f)", o: ["Periodo", "Ciclo", "Elongaci√≥n"] },
        { c: "M√°ximo desplazamiento desde la posici√≥n de equilibrio.", q: "¬øC√≥mo se llama?", r: "Amplitud (A)", o: ["Elongaci√≥n", "Vector", "Fase"] },
        { c: "Unidad de frecuencia en el Sistema Internacional.", q: "¬øCu√°l es?", r: "Hertz (Hz)", o: ["Segundos", "Radianes", "Metros"] },
        { c: "Posici√≥n instant√°nea respecto al centro de oscilaci√≥n.", q: "¬øC√≥mo se denomina?", r: "Elongaci√≥n (x)", o: ["Fase", "Amplitud", "Distancia"] },
        { c: "Fuerza que siempre apunta hacia el centro de oscilaci√≥n.", q: "¬øQu√© tipo de fuerza es?", r: "Fuerza Recuperadora", o: ["Fuerza Normal", "Fuerza de Fricci√≥n", "Fuerza Centr√≠peta"] },
        { c: "En los extremos de la trayectoria, la velocidad es:", q: "¬øCu√°l es su valor?", r: "Cero", o: ["M√°xima", "Media", "Constante"] },
        { c: "En el punto de equilibrio, la aceleraci√≥n es:", q: "¬øCu√°l es su valor?", r: "Cero", o: ["M√°xima", "Infinita", "Negativa"] },
        { c: "Tipo de energ√≠a que depende de la constante 'k' y la posici√≥n 'x'.", q: "¬øCu√°l es?", r: "Energ√≠a Potencial El√°stica", o: ["Energ√≠a Cin√©tica", "Energ√≠a Qu√≠mica", "Energ√≠a Gravitatoria"] },
        { c: "Magnitud medida en radianes por segundo (rad/s).", q: "¬øCu√°l es?", r: "Frecuencia Angular (œâ)", o: ["Velocidad", "Frecuencia", "Periodo"] }
    ];

    const preguntasNivel2 = [
        { c: "Ley de Hooke (Fuerza de un resorte).", q: "¬øCu√°l es la f√≥rmula?", r: "F = -k ¬∑ x", o: ["F = m ¬∑ a", "F = k / x", "F = -k ¬∑ A"] },
        { c: "Relaci√≥n entre frecuencia angular (œâ) y periodo (T).", q: "¬øCu√°l es correcta?", r: "œâ = 2œÄ / T", o: ["œâ = 2œÄ ¬∑ T", "œâ = T / 2œÄ", "œâ = f / T"] },
        { c: "Expresi√≥n de la posici√≥n x en funci√≥n del tiempo.", q: "¬øCu√°l es?", r: "x = A ¬∑ cos(œât)", o: ["x = A ¬∑ sen(t)", "x = œâ ¬∑ cos(At)", "x = V ¬∑ t"] },
        { c: "C√°lculo de la velocidad m√°xima (Vmax).", q: "¬øCu√°l es la expresi√≥n?", r: "Vmax = œâ ¬∑ A", o: ["Vmax = œâ¬≤ ¬∑ A", "Vmax = A / œâ", "Vmax = k ¬∑ x"] },
        { c: "C√°lculo de la aceleraci√≥n m√°xima (amax).", q: "¬øCu√°l es la expresi√≥n?", r: "amax = œâ¬≤ ¬∑ A", o: ["amax = œâ ¬∑ A", "amax = -k ¬∑ x", "amax = A / T¬≤"] },
        { c: "Si k = œâ¬≤ ¬∑ m, ¬øa qu√© es igual la masa (m)?", q: "Despeje la masa:", r: "m = k / œâ¬≤", o: ["m = k ¬∑ œâ¬≤", "m = œâ¬≤ / k", "m = ‚àö(k/œâ)"] },
        { c: "Relaci√≥n entre frecuencia (f), pulsos (q) y tiempo (T).", q: "¬øCu√°l es la f√≥rmula del PDF?", r: "f = q / T", o: ["f = T / q", "f = 2œÄ ¬∑ T", "f = 1 + T"] },
        { c: "Ecuaci√≥n de la velocidad instant√°nea V.", q: "¬øCu√°l es?", r: "V = -œâ¬∑A¬∑sen(œât)", o: ["V = œâ¬∑A¬∑cos(œât)", "V = -œâ¬≤¬∑A¬∑sen(œât)", "V = A¬∑cos(œât)"] }
    ];

    function iniciarTemporizador() {
        clearInterval(timerId);
        timeLeft = 120; 
        actualizarDisplayTimer();
        timerId = setInterval(() => {
            timeLeft--;
            actualizarDisplayTimer();
            if (timeLeft <= 0) {
                clearInterval(timerId);
                finalizarReporte();
            }
        }, 1000);
    }

    function actualizarDisplayTimer() {
        const min = Math.floor(timeLeft / 60);
        const sec = timeLeft % 60;
        document.getElementById('timerDisplay').innerText = `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
    }

    function comenzarJuego(nivel) {
        if (nivel === 1) {
            nombreUsuario = document.getElementById('inputNombre').value.trim();
            equipoUsuario = document.getElementById('inputEquipo').value.trim();
            if (!nombreUsuario || !equipoUsuario) { alert("Completa tus datos"); return; }
        }
        nivelActual = nivel;
        preguntaActual = 1;
        aciertosEnNivelActual = 0;
        document.getElementById('displayNombre').innerText = nombreUsuario;
        document.getElementById('displayEquipo').innerText = equipoUsuario;
        document.getElementById('displayNivel').innerText = "Nivel " + nivelActual;
        document.getElementById('pantallaInicio').classList.add('hidden');
        document.getElementById('pantallaFinal').classList.add('hidden');
        document.getElementById('pantallaJuego').classList.remove('hidden');
        iniciarTemporizador();
        generarPregunta();
    }

    function generarPregunta() {
        const banco = nivelActual === 1 ? preguntasNivel1 : preguntasNivel2;
        const p = banco[preguntaActual - 1];
        
        document.getElementById('numPregunta').innerText = preguntaActual;
        document.getElementById('txtContexto').innerText = p.c;
        document.getElementById('areaPregunta').innerText = p.q;
        respuestaCorrecta = p.r;

        const areaBotones = document.getElementById('areaBotones');
        areaBotones.innerHTML = "";
        
        let opciones = [p.r, ...p.o];
        opciones.sort(() => Math.random() - 0.5);

        opciones.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "btn-opt";
            btn.innerText = opt;
            btn.onclick = () => evaluar(opt);
            areaBotones.appendChild(btn);
        });
    }

    function evaluar(seleccion) {
        if (seleccion === respuestaCorrecta) aciertosEnNivelActual++;
        
        const limite = nivelActual === 1 ? 10 : 8;
        if (preguntaActual < limite) {
            preguntaActual++;
            generarPregunta();
        } else {
            clearInterval(timerId);
            if (nivelActual === 1) {
                aciertosNivel1 = aciertosEnNivelActual;
                if (aciertosNivel1 >= 7) mostrarTransicion();
                else finalizarReporte();
            } else {
                aciertosNivel2 = aciertosEnNivelActual;
                finalizarReporte();
            }
        }
    }

    function mostrarTransicion() {
        document.getElementById('pantallaJuego').classList.add('hidden');
        document.getElementById('pantallaFinal').classList.remove('hidden');
        document.getElementById('tituloFinal').innerText = "¬°Nivel 1 Completado! üîì";
        document.getElementById('tituloFinal').style.color = "#28a745";
        document.getElementById('scoreDetalle').innerText = aciertosNivel1 + " / 10";
        actualizarReporteUI();
        document.getElementById('contenedorAccionesFinales').innerHTML = `<button class="btn-next-level" onclick="comenzarJuego(2)">PASAR A F√ìRMULAS (Nivel 2)</button>`;
    }

    function actualizarReporteUI() {
        document.getElementById('resNombre').innerText = nombreUsuario;
        document.getElementById('resEquipo').innerText = equipoUsuario;
        document.getElementById('resFecha').innerText = new Date().toLocaleString();
        document.getElementById('resNivel1').innerText = aciertosNivel1 + " / 10";
        document.getElementById('resNivel2').innerText = nivelActual === 2 ? aciertosNivel2 + " / 8" : "Pendiente";
    }

    function finalizarReporte() {
        clearInterval(timerId);
        document.getElementById('pantallaJuego').classList.add('hidden');
        document.getElementById('pantallaFinal').classList.remove('hidden');
        if(nivelActual === 1) aciertosNivel1 = aciertosEnNivelActual;
        else aciertosNivel2 = aciertosEnNivelActual;
        
        actualizarReporteUI();
        const total = aciertosNivel1 + (nivelActual === 2 ? aciertosNivel2 : 0);
        document.getElementById('scoreDetalle').innerText = total + " pts";
        
        const resEstado = document.getElementById('resEstado');
        if (total >= 12) {
            document.getElementById('tituloFinal').innerText = "¬°EVALUACI√ìN EXITOSA! üèÜ";
            resEstado.innerText = "APROBADO ‚úÖ";
            resEstado.className = "report-value success-text";
        } else {
            document.getElementById('tituloFinal').innerText = "RESULTADO FINAL";
            resEstado.innerText = "NO ALCANZADO ‚ùå";
            resEstado.className = "report-value fail-text";
        }
        document.getElementById('contenedorAccionesFinales').innerHTML = ""; 
    }
</script>
</body>
</html>